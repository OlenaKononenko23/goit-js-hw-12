{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function getImage(value, page) {\n  const KEY = '43045088-79308e5151ececf264bff6e88';\n  const BASE_URL = 'https://pixabay.com/api/';\n\n  const params = new URLSearchParams({\n    key: KEY,\n    q: value,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    per_page: 15,\n    page: page,\n    safesearch: true,\n  });\n  const url = `${BASE_URL}?${params}`;\n\n  const response = await axios.get(url);\n  return response.data;\n}","function imageTemplate(data) {\n    const {\n      largeImageURL,\n      webformatURL,\n      tags,\n      likes,\n      views,\n      comments,\n      downloads,\n    } = data;\n    return `<li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n              width=\"360\"\n              height=\"200\"\n              class=\"gallery-img\"\n          />\n          <ul class=\"gallery-descript\">\n          <li class=\"gallery-descript__item\"><span class=\"gallery-descript__span\">likes</span> ${likes}</li>\n          <li class=\"gallery-descript__item\"><span class=\"gallery-descript__span\">Views</span> ${views}</li>\n          <li class=\"gallery-descript__item\"><span class=\"gallery-descript__span\">Coments</span> ${comments}</li>\n          <li class=\"gallery-descript__item\"><span class=\"gallery-descript__span\">Downloads</span> ${downloads}</li>\n       </ul>\n      </a>\n  </li>`;\n  }\n  \n  export function imagesTemplate(arr) {\n    return arr.map(imageTemplate).join('');\n  }","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { getImage } from './js/pixabay-api';\nimport { imagesTemplate } from './js/render-functions';\n\nlet searchValue = '';\nlet page = 1;\nlet totalHits = 0;\nlet loadedImages = 0;\n\n\nconst formEl = document.querySelector('.form');\nconst listEL = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.load-more');\nconst divEl = document.querySelector('.loader');\n\nformEl.addEventListener('submit', async event => {\n  event.preventDefault();\n  listEL.innerHTML = '';\n  searchValue = event.target.elements.value.value;\n  page = 1;\n\n  if (searchValue) {\n    loadMoreBtn.classList.add('is-hidden');\n    divEl.classList.remove('is-hidden');\n    try {\n      const data = await getImage(searchValue, page);\n      totalHits = data.totalHits;\n      loadedImages = 0;\n      afterFetch(data);\n    } catch (error) {\n      console.log(error);\n    }\n  } else {\n    iziToast.error({\n      title: 'Error',\n      message: 'The search field is empty. Please try again!',\n    });\n  }\n  formEl.reset();\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  loadMoreBtn.disabled = true;\n  divEl.classList.remove('is-hidden');\n  try {\n    const data = await getImage(searchValue, ++page);\n    afterFetch(data);\n  } catch (error) {\n    console.log(error);\n  }\n  loadMoreBtn.disabled = false;\n});\n\nlet isFirstRequest = true;\n\nfunction afterFetch(data) {\n  loadedImages += data.hits.length;\n  if (!data.hits.length) {\n    iziToast.error({\n      title: 'Error',\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n    });\n  } else if (loadedImages >= totalHits) {\n    loadMoreBtn.classList.add('is-hidden');\n    iziToast.info({\n      title: 'Info',\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n  } else {\n    loadMoreBtn.classList.remove('is-hidden');\n  }\n\n  const markup = imagesTemplate(data.hits);\n  listEL.insertAdjacentHTML('beforeend', markup);\n  divEl.classList.add('is-hidden');\n\n \n  const galleryItem = document.querySelector('.gallery-item');\n  if (galleryItem) {\n    const cardHeight = galleryItem.getBoundingClientRect().height;\n    window.scrollBy({ top: cardHeight * 2, behavior: 'smooth' });\n  }\n\n  const lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n}"],"names":["getImage","value","page","KEY","BASE_URL","params","url","axios","imageTemplate","data","largeImageURL","webformatURL","tags","likes","views","comments","downloads","imagesTemplate","arr","searchValue","totalHits","loadedImages","formEl","listEL","loadMoreBtn","divEl","event","afterFetch","error","iziToast","markup","galleryItem","cardHeight","SimpleLightbox"],"mappings":"owBAEO,eAAeA,EAASC,EAAOC,EAAM,CAC1C,MAAMC,EAAM,qCACNC,EAAW,2BAEXC,EAAS,IAAI,gBAAgB,CACjC,IAAKF,EACL,EAAGF,EACH,WAAY,QACZ,YAAa,aACb,SAAU,GACV,KAAMC,EACN,WAAY,EAChB,CAAG,EACKI,EAAM,GAAGF,CAAQ,IAAIC,CAAM,GAGjC,OADiB,MAAME,EAAM,IAAID,CAAG,GACpB,IAClB,CCnBA,SAASE,EAAcC,EAAM,CACzB,KAAM,CACJ,cAAAC,EACA,aAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACD,EAAGP,EACJ,MAAO;AAAA,sCAC2BC,CAAa;AAAA;AAAA,qBAE9BC,CAAY;AAAA,qBACZC,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iGAMwEC,CAAK;AAAA,iGACLC,CAAK;AAAA,mGACHC,CAAQ;AAAA,qGACNC,CAAS;AAAA;AAAA;AAAA,QAI3G,CAEM,SAASC,EAAeC,EAAK,CAClC,OAAOA,EAAI,IAAIV,CAAa,EAAE,KAAK,EAAE,CACzC,CCtBA,IAAIW,EAAc,GACdjB,EAAO,EACPkB,EAAY,EACZC,EAAe,EAGnB,MAAMC,EAAS,SAAS,cAAc,OAAO,EACvCC,EAAS,SAAS,cAAc,UAAU,EAC1CC,EAAc,SAAS,cAAc,YAAY,EACjDC,EAAQ,SAAS,cAAc,SAAS,EAE9CH,EAAO,iBAAiB,SAAU,MAAMI,GAAS,CAM/C,GALAA,EAAM,eAAc,EACpBH,EAAO,UAAY,GACnBJ,EAAcO,EAAM,OAAO,SAAS,MAAM,MAC1CxB,EAAO,EAEHiB,EAAa,CACfK,EAAY,UAAU,IAAI,WAAW,EACrCC,EAAM,UAAU,OAAO,WAAW,EAClC,GAAI,CACF,MAAMhB,EAAO,MAAMT,EAASmB,EAAajB,CAAI,EAC7CkB,EAAYX,EAAK,UACjBY,EAAe,EACfM,EAAWlB,CAAI,CAChB,OAAQmB,EAAO,CACd,QAAQ,IAAIA,CAAK,CAClB,CACL,MACIC,EAAS,MAAM,CACb,MAAO,QACP,QAAS,8CACf,CAAK,EAEHP,EAAO,MAAK,CACd,CAAC,EAEDE,EAAY,iBAAiB,QAAS,SAAY,CAChDA,EAAY,SAAW,GACvBC,EAAM,UAAU,OAAO,WAAW,EAClC,GAAI,CACF,MAAMhB,EAAO,MAAMT,EAASmB,EAAa,EAAEjB,CAAI,EAC/CyB,EAAWlB,CAAI,CAChB,OAAQmB,EAAO,CACd,QAAQ,IAAIA,CAAK,CAClB,CACDJ,EAAY,SAAW,EACzB,CAAC,EAID,SAASG,EAAWlB,EAAM,CACxBY,GAAgBZ,EAAK,KAAK,OACrBA,EAAK,KAAK,OAMJY,GAAgBD,GACzBI,EAAY,UAAU,IAAI,WAAW,EACrCK,EAAS,KAAK,CACZ,MAAO,OACP,QAAS,4DACf,CAAK,GAEDL,EAAY,UAAU,OAAO,WAAW,EAZxCK,EAAS,MAAM,CACb,MAAO,QACP,QACE,0EACR,CAAK,EAWH,MAAMC,EAASb,EAAeR,EAAK,IAAI,EACvCc,EAAO,mBAAmB,YAAaO,CAAM,EAC7CL,EAAM,UAAU,IAAI,WAAW,EAG/B,MAAMM,EAAc,SAAS,cAAc,eAAe,EAC1D,GAAIA,EAAa,CACf,MAAMC,EAAaD,EAAY,sBAAqB,EAAG,OACvD,OAAO,SAAS,CAAE,IAAKC,EAAa,EAAG,SAAU,QAAQ,CAAE,CAC5D,CAEgB,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,aAAc,GAClB,CAAG,CACH"}